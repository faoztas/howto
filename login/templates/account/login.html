{% extends "account/base.html" %}
{%block bass%}
{% load i18n %}
{% load account socialaccount %}

{% block content %}

<div class="ui centered header"><h1>{% trans "Giriş Yap" %}</h1></div>
<div class="ui divider"></div>
<div class="ui grid">
    <div class="three wide column"></div>
    <div class="four wide column">
      {% get_providers as socialaccount_providers %}
      <br><br>
      {% if socialaccount_providers %}
        <p>{% blocktrans with site.name as site_name %}Zaten bir sosyal paylaşım sitesi kullanıyor musun? 
          O zaman onlardan biri ile giriş yap. 
          Veya bir howto hesabına 
          <a href="{{ signup_url }}">Kayıt Ol!</a>
          {% endblocktrans %}</p>

        <div class="socialaccount_ballot">
          <ul class="socialaccount_providers">
            {% include "socialaccount/snippets/provider_list.html" with process="login" %}
          </ul>
        </div>

      {% include "socialaccount/snippets/login_extra.html" %}

      {% else %}
        <p>{% blocktrans %}Henüz bir hesap oluşturmadıysanız, lütfen önce 
        <a href="{{ signup_url }}">Kayıt Ol!</a> first.{% endblocktrans %}</p>
      {% endif %}
    </div>
    <div class="two wide column"><div class="ui vertical divider">
        or
    </div></div>
    <div class="one wide column"></div>
    <div class="four wide column">
    <form class="ui large form login" method="POST" action="{% url 'account_login' %}">
      {% csrf_token %}
      {{ form.as_p }}
      {% if redirect_field_value %}
      <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
      {% endif %}
      <button id="submit-button" class="ui disabled fluid large teal submit button primaryAction" type="submit">{% trans "Giriş Yap" %}</button>
      <a class="button secondaryAction" href="{% url 'account_reset_password' %}">{% trans "Şifremi Unuttum!" %}</a> 
    </form>
    </div>
</div>

<script type="text/javascript">
  $(document).ready(function(){
    var bool = false;
  });
  
  $("#id_login").focusin(function(){
        bool = true;
    });
    $("#id_login").focusout(function(){
        if(bool)
        {
          var element = $(this);
          if(element.val() != "")
          {
            $.ajax({
                      type :'POST',
                      url :'/getifuser/',
                      data : {
                        'search_q' : element.val(),
                        'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
                      },
                      dataType : "json",
                      success: function(data){
                          if(data['data'] == true)
                          {
                            element.removeClass('correct');
                            element.addClass('error');
                            $('#submit-button').addClass('disabled');
                          }
                          else{
                            element.removeClass('error');
                            element.addClass('correct');
                            $('#submit-button').removeClass('disabled');
                          }
                      },
                      error: function(rs, e){
                        element.removeClass('error');
                        element.removeClass('correct');
                      },
          
          
                    });
          }
        }
    });
</script>
{% endblock %}
{% endblock %}
